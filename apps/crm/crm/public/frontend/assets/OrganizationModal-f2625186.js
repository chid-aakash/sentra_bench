import{F as R}from"./FieldLayout-9051362d.js";import{i as B,E as I}from"./DragVerticalIcon-56a1fcba.js";import{u as j}from"./index-1be1092b.js";import{u as D,s as N,a as Q,c as A,q}from"./modals-6b779b18.js";import{m as F,B as P,i as S,l as E,z as T,a as U,I as k,e as g,f as u,g as m,w as _,d as n,t as $,u as c,b as p,p as y,a3 as J,E as L,J as G}from"./index-77a1adb3.js";const H={class:"px-4 pt-5 pb-6 bg-surface-modal sm:px-6"},K={class:"flex items-center justify-between mb-5"},W={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},X={class:"flex items-center gap-1"},Y={class:"px-4 pt-4 pb-7 sm:px-6"},Z={class:"space-y-2"},ne={__name:"OrganizationModal",props:F({data:{type:Object,default:()=>({})},options:{type:Object,default:{redirect:!0,afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v){const d=v,{isManager:O}=j(),x=P(),r=S(v,"modelValue"),M=E(!1),f=E(null),{document:i}=D("CRM Organization");async function C(){const e=await L("frappe.client.insert",{doc:{doctype:"CRM Organization",...i.doc}},{onError:a=>{var o,l;a.error.exc_type=="ValidationError"&&(f.value=(l=(o=a.error)==null?void 0:o.messages)==null?void 0:l[0])}});M.value=!1,e.name&&(G("organization_created"),w(e))}function w(e){e.name&&d.options.redirect&&x.push({name:"Organization",params:{organizationId:e.name}}),r.value=!1,d.options.afterInsert&&d.options.afterInsert(e)}const b=T({url:"crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["QuickEntry","CRM Organization"],params:{doctype:"CRM Organization",type:"Quick Entry"},auto:!0,transform:e=>e.forEach(a=>{a.sections.forEach(o=>{o.columns.forEach(l=>{l.fields.forEach(t=>{t.fieldname=="address"?(t.create=(s,z)=>{i.doc.address=s,h(),z()},t.edit=s=>h(s)):t.fieldtype==="Table"&&(i.doc[t.fieldname]=[])})})})})});U(()=>{i.doc={no_of_employees:"1-10"},Object.assign(i.doc,d.data)});function V(){A.value=!0,q.value={doctype:"CRM Organization"},k(()=>r.value=!1)}function h(e){N.value=!0,Q.value={doctype:"Address",address:e},k(()=>r.value=!1)}return(e,a)=>{const o=g("Button"),l=g("ErrorMessage"),t=g("Dialog");return u(),m(t,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=s=>r.value=s),options:{size:"xl"}},{body:_(()=>{var s;return[n("div",H,[n("div",K,[n("div",null,[n("h3",W,$(e.__("New Organization")),1)]),n("div",X,[c(O)()&&!c(B)?(u(),m(o,{key:0,variant:"ghost",class:"w-7",onClick:V},{icon:_(()=>[p(I)]),_:1})):y("",!0),p(o,{variant:"ghost",class:"w-7",onClick:a[0]||(a[0]=z=>r.value=!1)},{icon:_(()=>[p(c(J),{name:"x",class:"size-4"})]),_:1})])]),(s=c(b).data)!=null&&s.length?(u(),m(R,{key:0,tabs:c(b).data,data:c(i).doc,doctype:"CRM Organization"},null,8,["tabs","data"])):y("",!0),f.value?(u(),m(l,{key:1,class:"mt-8",message:e.__(f.value)},null,8,["message"])):y("",!0)]),n("div",Y,[n("div",Z,[p(o,{class:"w-full",variant:"solid",label:e.__("Create"),loading:M.value,onClick:C},null,8,["label","loading"])])])]}),_:1},8,["modelValue"])}}};export{ne as _};
//# sourceMappingURL=OrganizationModal-f2625186.js.map

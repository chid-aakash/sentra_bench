import{N as B,l as w,x as Z,X as we,V as fe,j as _,aK as z,P as re,a as U,k as de,aX as _e,U as I,Q as W,Y as Ie,F as ae,R as pe,ak as ve,S as H,b2 as ce,aS as Y,$ as P,aQ as X,bn as Se,aN as Ce,aO as M,aP as k,I as se,f as C,g as R,w as O,c as N,r as he,u as $,a6 as T,y as L,d as G,n as F,C as $e,p as K,D as De,t as oe,m as Pe,i as ke,b as j,as as J,at as ee,e as le,a4 as ge,a5 as me,aI as Ae,al as Oe,bo as Re,au as Te,v as be,ad as Fe,G as te,bc as Ee,E as Me,ar as Ne,z as je}from"./index-77a1adb3.js";import{s as Be}from"./Dropdown.vue_vue_type_script_setup_true_lang-20f66514.js";import{g as Le,b as ne,F as Ve,G as ze}from"./index-1be1092b.js";let qe=B({props:{onFocus:{type:Function,required:!0}},setup(e){let l=w(!0);return()=>l.value?Z(fe,{as:"button",type:"button",features:we.Focusable,onFocus(d){d.preventDefault();let c,p=50;function i(){var u;if(p--<=0){c&&cancelAnimationFrame(c);return}if((u=e.onFocus)!=null&&u.call(e)){l.value=!1,cancelAnimationFrame(c);return}c=requestAnimationFrame(i)}c=requestAnimationFrame(i)}}):null}});var Ge=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Ge||{}),Ke=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Ke||{});let ye=Symbol("TabsContext");function Q(e){let l=H(ye,null);if(l===null){let d=new Error(`<${e} /> is missing a parent <TabGroup /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(d,Q),d}return l}let ue=Symbol("TabsSSRContext"),Ue=B({name:"TabGroup",emits:{change:e=>!0},props:{as:{type:[Object,String],default:"template"},selectedIndex:{type:[Number],default:null},defaultIndex:{type:[Number],default:0},vertical:{type:[Boolean],default:!1},manual:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(e,{slots:l,attrs:d,emit:c}){var p;let i=w((p=e.selectedIndex)!=null?p:e.defaultIndex),u=w([]),o=w([]),m=_(()=>e.selectedIndex!==null),x=_(()=>m.value?e.selectedIndex:i.value);function v(t){var a;let n=z(s.tabs.value,I),r=z(s.panels.value,I),g=n.filter(y=>{var S;return!((S=I(y))!=null&&S.hasAttribute("disabled"))});if(t<0||t>n.length-1){let y=Y(i.value===null?0:Math.sign(t-i.value),{[-1]:()=>1,0:()=>Y(Math.sign(t),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0}),S=Y(y,{0:()=>n.indexOf(g[0]),1:()=>n.indexOf(g[g.length-1])});S!==-1&&(i.value=S),s.tabs.value=n,s.panels.value=r}else{let y=n.slice(0,t),S=[...n.slice(t),...y].find(V=>g.includes(V));if(!S)return;let D=(a=n.indexOf(S))!=null?a:s.selectedIndex.value;D===-1&&(D=s.selectedIndex.value),i.value=D,s.tabs.value=n,s.panels.value=r}}let s={selectedIndex:_(()=>{var t,a;return(a=(t=i.value)!=null?t:e.defaultIndex)!=null?a:null}),orientation:_(()=>e.vertical?"vertical":"horizontal"),activation:_(()=>e.manual?"manual":"auto"),tabs:u,panels:o,setSelectedIndex(t){x.value!==t&&c("change",t),m.value||v(t)},registerTab(t){var a;if(u.value.includes(t))return;let n=u.value[i.value];if(u.value.push(t),u.value=z(u.value,I),!m.value){let r=(a=u.value.indexOf(n))!=null?a:i.value;r!==-1&&(i.value=r)}},unregisterTab(t){let a=u.value.indexOf(t);a!==-1&&u.value.splice(a,1)},registerPanel(t){o.value.includes(t)||(o.value.push(t),o.value=z(o.value,I))},unregisterPanel(t){let a=o.value.indexOf(t);a!==-1&&o.value.splice(a,1)}};re(ye,s);let f=w({tabs:[],panels:[]}),b=w(!1);U(()=>{b.value=!0}),re(ue,_(()=>b.value?null:f.value));let h=_(()=>e.selectedIndex);return U(()=>{de([h],()=>{var t;return v((t=e.selectedIndex)!=null?t:e.defaultIndex)},{immediate:!0})}),_e(()=>{if(!m.value||x.value==null||s.tabs.value.length<=0)return;let t=z(s.tabs.value,I);t.some((a,n)=>I(s.tabs.value[n])!==I(a))&&s.setSelectedIndex(t.findIndex(a=>I(a)===I(s.tabs.value[x.value])))}),()=>{let t={selectedIndex:i.value};return Z(ae,[u.value.length<=0&&Z(qe,{onFocus:()=>{for(let a of u.value){let n=I(a);if((n==null?void 0:n.tabIndex)===0)return n.focus(),!0}return!1}}),W({theirProps:{...d,...Ie(e,["selectedIndex","defaultIndex","manual","vertical","onChange"])},ourProps:{},slot:t,slots:l,attrs:d,name:"TabGroup"})])}}}),We=B({name:"TabList",props:{as:{type:[Object,String],default:"div"}},setup(e,{attrs:l,slots:d}){let c=Q("TabList");return()=>{let p={selectedIndex:c.selectedIndex.value},i={role:"tablist","aria-orientation":c.orientation.value};return W({ourProps:i,theirProps:e,slot:p,attrs:l,slots:d,name:"TabList"})}}}),He=B({name:"Tab",props:{as:{type:[Object,String],default:"button"},disabled:{type:[Boolean],default:!1},id:{type:String,default:null}},setup(e,{attrs:l,slots:d,expose:c}){var p;let i=(p=e.id)!=null?p:`headlessui-tabs-tab-${pe()}`,u=Q("Tab"),o=w(null);c({el:o,$el:o}),U(()=>u.registerTab(o)),ve(()=>u.unregisterTab(o));let m=H(ue),x=_(()=>{if(m.value){let r=m.value.tabs.indexOf(i);return r===-1?m.value.tabs.push(i)-1:r}return-1}),v=_(()=>{let r=u.tabs.value.indexOf(o);return r===-1?x.value:r}),s=_(()=>v.value===u.selectedIndex.value);function f(r){var g;let y=r();if(y===X.Success&&u.activation.value==="auto"){let S=(g=Ce(o))==null?void 0:g.activeElement,D=u.tabs.value.findIndex(V=>I(V)===S);D!==-1&&u.setSelectedIndex(D)}return y}function b(r){let g=u.tabs.value.map(y=>I(y)).filter(Boolean);if(r.key===P.Space||r.key===P.Enter){r.preventDefault(),r.stopPropagation(),u.setSelectedIndex(v.value);return}switch(r.key){case P.Home:case P.PageUp:return r.preventDefault(),r.stopPropagation(),f(()=>M(g,k.First));case P.End:case P.PageDown:return r.preventDefault(),r.stopPropagation(),f(()=>M(g,k.Last))}if(f(()=>Y(u.orientation.value,{vertical(){return r.key===P.ArrowUp?M(g,k.Previous|k.WrapAround):r.key===P.ArrowDown?M(g,k.Next|k.WrapAround):X.Error},horizontal(){return r.key===P.ArrowLeft?M(g,k.Previous|k.WrapAround):r.key===P.ArrowRight?M(g,k.Next|k.WrapAround):X.Error}}))===X.Success)return r.preventDefault()}let h=w(!1);function t(){var r;h.value||(h.value=!0,!e.disabled&&((r=I(o))==null||r.focus({preventScroll:!0}),u.setSelectedIndex(v.value),Se(()=>{h.value=!1})))}function a(r){r.preventDefault()}let n=Be(_(()=>({as:e.as,type:l.type})),o);return()=>{var r,g;let y={selected:s.value,disabled:(r=e.disabled)!=null?r:!1},{...S}=e,D={ref:o,onKeydown:b,onMousedown:a,onClick:t,id:i,role:"tab",type:n.value,"aria-controls":(g=I(u.panels.value[v.value]))==null?void 0:g.id,"aria-selected":s.value,tabIndex:s.value?0:-1,disabled:e.disabled?!0:void 0};return W({ourProps:D,theirProps:S,slot:y,attrs:l,slots:d,name:"Tab"})}}}),Qe=B({name:"TabPanels",props:{as:{type:[Object,String],default:"div"}},setup(e,{slots:l,attrs:d}){let c=Q("TabPanels");return()=>{let p={selectedIndex:c.selectedIndex.value};return W({theirProps:e,ourProps:{},slot:p,attrs:d,slots:l,name:"TabPanels"})}}}),Xe=B({name:"TabPanel",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null},tabIndex:{type:Number,default:0}},setup(e,{attrs:l,slots:d,expose:c}){var p;let i=(p=e.id)!=null?p:`headlessui-tabs-panel-${pe()}`,u=Q("TabPanel"),o=w(null);c({el:o,$el:o}),U(()=>u.registerPanel(o)),ve(()=>u.unregisterPanel(o));let m=H(ue),x=_(()=>{if(m.value){let f=m.value.panels.indexOf(i);return f===-1?m.value.panels.push(i)-1:f}return-1}),v=_(()=>{let f=u.panels.value.indexOf(o);return f===-1?x.value:f}),s=_(()=>v.value===u.selectedIndex.value);return()=>{var f;let b={selected:s.value},{tabIndex:h,...t}=e,a={ref:o,id:i,role:"tabpanel","aria-labelledby":(f=I(u.tabs.value[v.value]))==null?void 0:f.id,tabIndex:s.value?h:-1};return!s.value&&e.unmount&&!e.static?Z(fe,{as:"span","aria-hidden":!0,...a}):W({ourProps:a,theirProps:t,slot:b,attrs:l,slots:d,features:ce.Static|ce.RenderStrategy,visible:s.value,name:"TabPanel"})}}});const Ye={__name:"TabList",setup(e){const l=H("tab"),d=w([]),c=w(null),p=_(()=>{var o;return(o=l.value.tabs.value)==null?void 0:o.length}),i=w("");function u(o){o>=p.value&&(o=p.value-1);const m=d.value[o].el;l.value.vertical.value?(c.value.style.height=`${m.offsetHeight}px`,c.value.style.top=`${m.offsetTop}px`):(c.value.style.width=`${m.offsetWidth}px`,c.value.style.left=`${m.offsetLeft}px`)}return de(()=>l.value.tabIndex.value,o=>{o>=p.value&&(l.value.tabIndex.value=p.value-1),i.value="transition-all duration-300 ease-in-out",se(()=>u(o))}),U(()=>{se(()=>u(l.value.tabIndex.value)),setTimeout(()=>u(l.value.tabIndex.value),100)}),(o,m)=>(C(),R($(We),{class:F(["relative flex",$(l).vertical?"flex-col border-r overflow-y-auto":"gap-7.5 border-b overflow-x-auto items-center px-5"])},{default:O(()=>[(C(!0),N(ae,null,he($(l).tabs,(x,v)=>(C(),R($(He),{ref_for:!0,ref_key:"tabRef",ref:d,as:"template",key:v,class:"focus:outline-none focus:transition-none"},{default:O(({selected:s})=>[T(o.$slots,"default",L({ref_for:!0},{tab:x,selected:s}),()=>[G("button",{class:F(["flex items-center gap-1.5 text-base text-ink-gray-5 duration-300 ease-in-out hover:text-ink-gray-9",[s?"text-ink-gray-9":"",$(l).vertical?"py-2.5 px-4 border-r border-transparent hover:border-outline-gray-3":"py-3 border-b border-transparent hover:border-outline-gray-3"]])},[x.icon?(C(),R($e(x.icon),{key:0,class:"size-4"})):K("",!0),De(" "+oe(x.label),1)],2)])]),_:2},1024))),128)),G("div",{ref_key:"indicator",ref:c,class:F(["tab-indicator absolute bg-surface-gray-7",[$(l).vertical?"right-0 w-px":"bottom-0 h-px",i.value]])},null,2)]),_:3},8,["class"]))}},Ze={__name:"TabPanel",setup(e){const l=H("tab");return(d,c)=>(C(),R($(Qe),{class:"flex flex-1 overflow-hidden"},{default:O(()=>[(C(!0),N(ae,null,he($(l).tabs,(p,i)=>(C(),R($(Xe),{class:"flex flex-1 flex-col overflow-y-auto focus:outline-none",key:i},{default:O(()=>[T(d.$slots,"default",L({ref_for:!0},{tab:p}))]),_:2},1024))),128))]),_:3}))}},rt={__name:"Tabs",props:Pe({as:{type:String,default:"template"},tabs:{type:Array,required:!0},vertical:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const l=e,d=ke(e,"modelValue");return re("tab",_(()=>({tabIndex:d,tabs:l.tabs,vertical:l.vertical}))),(c,p)=>(C(),R($(Ue),L(e.as!=="template"?{as:e.as,class:["flex flex-1 overflow-hidden",e.vertical?"":"flex-col "]}:{},{defaultIndex:d.value,selectedIndex:d.value,onChange:p[0]||(p[0]=i=>d.value=i)}),{default:O(()=>[T(c.$slots,"default",{},()=>[j(Ye,null,{default:O(({tab:i,selected:u})=>[T(c.$slots,"tab-item",J(ee({tab:i,selected:u})))]),_:3}),j(Ze,null,{default:O(({tab:i})=>[T(c.$slots,"tab-panel",J(ee({tab:i})))]),_:3})])]),_:3},16,["defaultIndex","selectedIndex"]))}},Je={inheritAttrs:!1},st=Object.assign(Je,{__name:"Section",props:{label:{type:String,default:""},hideLabel:{type:Boolean,default:!1},opened:{type:Boolean,default:!0},collapsible:{type:Boolean,default:!0},collapseIconPosition:{type:String,default:"left"},labelClass:{type:[String,Object,Array],default:""},headerClass:{type:[String,Object,Array],default:""}},setup(e){const l=e,d=w(l.hideLabel),c=w(l.opened);function p(){c.value=!c.value}function i(){c.value=!0}function u(){c.value=!1}return(o,m)=>{const x=le("FeatherIcon");return C(),N("div",null,[T(o.$slots,"header",J(ee({opened:c.value,hide:d.value,open:i,close:u,toggle:p})),()=>[d.value?K("",!0):(C(),N("div",{key:0,class:F(["section-header flex items-center justify-between",e.headerClass])},[G("div",{class:F(["flex text-ink-gray-9 max-w-fit cursor-pointer items-center gap-2 text-base",e.labelClass]),onClick:m[0]||(m[0]=v=>e.collapsible&&p())},[e.collapsible&&e.collapseIconPosition==="left"?(C(),R(x,{key:0,name:"chevron-right",class:F(["h-4 transition-all duration-300 ease-in-out",{"rotate-90":c.value}])},null,8,["class"])):K("",!0),G("span",null,oe(o.__(e.label)||o.__("Untitled")),1),e.collapsible&&e.collapseIconPosition==="right"?(C(),R(x,{key:1,name:"chevron-right",class:F(["h-4 transition-all duration-300 ease-in-out",{"rotate-90":c.value}])},null,8,["class"])):K("",!0)],2),T(o.$slots,"actions")],2))]),j(Ae,{"enter-active-class":"duration-300 ease-in","leave-active-class":"duration-300 ease-[cubic-bezier(0, 1, 0.5, 1)]","enter-to-class":"max-h-[200px] overflow-hidden","leave-from-class":"max-h-[200px] overflow-hidden","enter-from-class":"max-h-0 overflow-hidden","leave-to-class":"max-h-0 overflow-hidden"},{default:O(()=>[ge(G("div",L({class:"columns"},o.$attrs),[T(o.$slots,"default",J(ee({opened:c.value,open:i,close:u,toggle:p})))],16),[[me,c.value]])]),_:3})])}}}),lt={__name:"Password",props:{modelValue:{type:[String,Number],default:""},value:{type:[String,Number],default:""}},setup(e){const l=e,d=w(!1),c=_(()=>{let p=l.modelValue||l.value;return!(p!=null&&p.includes("*"))});return(p,i)=>{const u=le("FeatherIcon"),o=le("Button");return C(),R($(Oe),L({type:d.value?"text":"password",value:e.modelValue||e.value},p.$attrs),{suffix:O(()=>[ge(j(o,{class:"!h-4",onClick:i[0]||(i[0]=m=>d.value=!d.value)},{default:O(()=>[j(u,{name:d.value?"eye-off":"eye",class:"h-3"},null,8,["name"])]),_:1},512),[[me,c.value]])]),_:1},16,["type","value"])}}},ot={__name:"FormattedInput",props:{value:{type:[String,Number],default:""},formattedValue:{type:[String,Number],default:""}},setup(e){const l=e,d=Re(),c=w(!1),p=w(null);function i(){c.value=!0,se(()=>{var m;p.value&&((m=p.value.el)==null||m.select())})}const u=_(()=>c.value?l.value:l.formattedValue||l.value),o=_(()=>[{sm:"text-xs",md:"text-base"}[d.size||"sm"],"text-ink-gray-5"]);return(m,x)=>(C(),N(ae,null,[j($(Te),L({ref_key:"inputRef",ref:p,value:u.value,onFocus:i,onBlur:x[0]||(x[0]=v=>c.value=!1)},m.$attrs),null,16,["value"]),T(m.$slots,"description",{},()=>[$(d).description?(C(),N("p",{key:0,class:F(["mt-1.5",o.value])},oe($(d).description),3)):K("",!0)])],64))}},q=be({});function et(e,l="Form"){const d=Fe({doctype:"CRM Form Script",cache:["Form Scripts",e,l],fields:["name","dt","view","script"],filters:{view:l,dt:e,enabled:1},onSuccess:v=>{for(let s of v)q[e]||(q[e]={}),q[e][s.name]=s||{}},onError:v=>{console.error(`Error loading CRM Form Scripts for ${e} (view: ${l}):`,v)}});!q[e]&&!d.loading&&d.fetch();async function c(v,s={}){await d.list.promise;let f=q[e];if(!f||Object.keys(f).length===0)return null;const{$dialog:b,$socket:h,makeCall:t}=Le();return s.createDialog=b,s.toast=te,s.socket=h,s.router=Ee,s.call=Me,s.throwError=a=>{throw te.error(a||__("An error occurred")),new Error(a||__("An error occurred"))},s.crm={makePhoneCall:t},p(f,v,s)}function p(v,s,f){var t;const b=[];let h=null;for(let a in v){let n=(t=v[a])==null?void 0:t.script;if(n)try{const r=o(n);if(!r)continue;r.forEach(g=>{const y=m(n,g,f);if(!y)return;let S=null,D=e.replace(/\s+/g,""),{doctypeMeta:V}=ne(e),ie=g!==D;if(ie){if(!b.length){console.error(__("⚠️ No class found for doctype: {0}, it is mandatory to have a class for the parent doctype. it can be empty, but it should be present.",[e]));return}S=b[h]}else h=b.length||0;const xe=i(y,V,s,S,ie);b.push(xe)})}catch(r){console.error(__("Failed to load form controller: {0}",[r]))}}return b}function i(v,s,f,b=null,h=!1){f.actions=f.actions||[],f.statuses=f.statuses||[];let t=new v;t._originalDocumentContext=f,t._isChildDoctype=h;for(const n in f)f.hasOwnProperty(n)&&(t[n]=f[n]);t.getMeta=async n=>(s[n]||await ne(n),s[n]);const a=()=>f.doc;return h?(t.doc=x(a,b,t),b._childInstances||(b._childInstances=[]),b._childInstances.push(t)):t.doc=x(a,t),t}function u(v){typeof v.prototype.getRow!="function"&&(v.prototype.getRow=function(s,f){var t,a;f=f||this.currentRowIdx;let b=null;if(this instanceof Array){const{getFields:n}=ne(this.doc.doctype);let g=n().find(y=>y.fieldname===s);b=(t=g==null?void 0:g.options)==null?void 0:t.replace(/\s+/g,""),!f&&b&&(f=(a=this.find(y=>y.constructor.name===b))==null?void 0:a.currentRowIdx)}if(!this.doc[s])return console.warn(__("⚠️ No data found for parent field: {0}",[s])),null;const h=this.doc[s].find(n=>n.idx===f);return h?(h.parent=h.parent||this.doc.name,this instanceof Array&&b?x(h,this.find(n=>n.constructor.name===b)):x(h,this)):(console.warn(__("⚠️ No row found for idx: {0} in parent field: {1}",[f,s])),null)}),Object.prototype.hasOwnProperty.call(v.prototype,"actions")||Object.defineProperty(v.prototype,"actions",{configurable:!0,enumerable:!0,get(){return this._originalDocumentContext?this._originalDocumentContext.actions:(console.warn("CRM Script: _originalDocumentContext not found on instance for actions getter."),[])},set(s){if(!this._originalDocumentContext){console.warn("CRM Script: _originalDocumentContext not found on instance for actions setter.");return}if(!Array.isArray(s)){console.warn('CRM Script: "actions" property must be an array. Value was not set.',s),this._originalDocumentContext.actions=[];return}this._originalDocumentContext.actions=s}}),Object.prototype.hasOwnProperty.call(v.prototype,"statuses")||Object.defineProperty(v.prototype,"statuses",{configurable:!0,enumerable:!0,get(){return this._originalDocumentContext?this._originalDocumentContext.statuses:(console.warn("CRM Script: _originalDocumentContext not found on instance for statuses getter."),[])},set(s){if(!this._originalDocumentContext){console.warn("CRM Script: _originalDocumentContext not found on instance for statuses setter.");return}if(!Array.isArray(s)){console.warn('CRM Script: "statuses" property must be an array. Value was not set.',s),this._originalDocumentContext.statuses=[];return}this._originalDocumentContext.statuses=s}})}function o(v){return[...v.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").matchAll(/class\s+([A-Za-z0-9_]+)/g)].map(f=>f[1])||[]}function m(v,s,f={}){const b=Object.keys(f),h=Object.values(f),t=`
		${v}
		return ${s};
	`,a=new Function(...b,t)(...h);return u(a),a}function x(v,s,f=null){const b=typeof v=="function",h=()=>b?v():v;return new Proxy({},{get(t,a){const n=h();if(n)return a==="trigger"?(n&&"trigger"in n&&console.warn(__('⚠️ Avoid using "trigger" as a field name — it conflicts with the built-in trigger() method.')),(r,...g)=>{const y=s[r];if(typeof y=="function")return y.apply(s,g);console.warn(__('⚠️ Method "{0}" not found in class.',[r]))}):a==="getRow"?s.getRow.bind(f||s._childInstances||s):n[a]},set(t,a,n){const r=h();return r?(r[a]=n,!0):!1},has(t,a){const n=h();return n?a in n:!1},ownKeys(t){const a=h();return a?Reflect.ownKeys(a):[]},getOwnPropertyDescriptor(t,a){const n=h();if(n)return Reflect.getOwnPropertyDescriptor(n,a)}})}return{scripts:d,setupScript:c,setupFormController:i}}const A={},E={};function ut(e,l){const{setupScript:d}=et(e);A[e]=A[e]||{},A[e][l||""]||(l?A[e][l]=Ne({doctype:e,name:l,onSuccess:async()=>await p(),setValue:{onSuccess:()=>{o(),te.success(__("Document updated successfully"))},onError:t=>{let a=__("Error updating document");if(t.exc_type=="MandatoryError"){const n=t.messages.map(r=>r.split(": ")[2].trim()).join(", ");a=__("Mandatory field error: {0}",[n])}te.error(a),console.error(t)}}}):(A[e][""]=be({doc:{}}),p()));const c=je({url:"crm.api.doc.get_assigned_users",cache:`assignees:${e}:${l}`,auto:!!l,params:{doctype:e,name:l},transform:t=>Ve(t)});async function p(){if(E[e]&&typeof E[e][l||""]=="object")return;E[e]||(E[e]={}),E[e][l||""]={};const t=await d(A[e][l||""]);if(!t||t.length===0)return;const a={};for(const n of t){const r=n.constructor.name;a[r]||(a[r]=[]),a[r].push(n)}E[e][l||""]=a,u()}function i(t=null){var g;const n=((t==null?void 0:t.doctype)||e).replace(/\s+/g,""),r=(g=E[e])==null?void 0:g[l||""];return typeof r=="object"&&r!==null&&!Array.isArray(r)?r[n]||[]:[]}async function u(){await h(async function(){var a,n,r;await(((a=this.onLoad)==null?void 0:a.call(this))||((n=this.on_load)==null?void 0:n.call(this))||((r=this.onload)==null?void 0:r.call(this)))})}async function o(){await h(async function(){var a,n;await(((a=this.onSave)==null?void 0:a.call(this))||((n=this.on_save)==null?void 0:n.call(this)))})}async function m(){await h(async function(){var a;await((a=this.refresh)==null?void 0:a.call(this))})}async function x(t,a,n){const r=A[e][l||""].doc[t];A[e][l||""].doc[t]=a;const g=async function(){var y;this.value=a,this.oldValue=r,n&&(this.currentRowIdx=n.idx),await((y=this[t])==null?void 0:y.call(this))};try{await h(g,n)}catch(y){throw A[e][l||""].doc[t]=r,console.error(g),y}}async function v(t){await h(async function(){var n;this.currentRowIdx=t.idx,this.value=t,await((n=this[t.parentfield+"_add"])==null?void 0:n.call(this))},t)}async function s(t,a){await h(async function(){var r;if(t.size===1){const g=Array.from(t)[0];this.currentRowIdx=a.find(y=>y.name===g).idx}else delete this.currentRowIdx;this.selectedRows=Array.from(t),this.rows=a,await((r=this[a[0].parentfield+"_remove"])==null?void 0:r.call(this))},a[0])}async function f(){const t=Array.from(arguments);await h(async function(){var n,r;await(((n=this.onCreateLead)==null?void 0:n.call(this,...t))||((r=this.on_create_lead)==null?void 0:r.call(this,...t)))})}async function b(){const t=Array.from(arguments);await h(async function(){var n,r;await(((n=this.convertToDeal)==null?void 0:n.call(this,...t))||((r=this.on_convert_to_deal)==null?void 0:r.call(this,...t)))})}async function h(t,a=null){const n=i(a);if(!n.length)return;const r=n.map(g=>async()=>await t.call(g));await ze(r)}return{document:A[e][l||""],assignees:c,getControllers:i,triggerOnLoad:u,triggerOnSave:o,triggerOnRefresh:m,triggerOnChange:x,triggerOnRowAdd:v,triggerOnRowRemove:s,setupFormScript:p,triggerOnCreateLead:f,triggerConvertToDeal:b}}const it=w(!1),ct=w({}),ft=w(!1),dt=w({}),pt=w(!1);export{rt as _,dt as a,st as b,it as c,Ye as d,Ze as e,ot as f,lt as g,pt as h,ct as q,ft as s,ut as u};
//# sourceMappingURL=modals-6b779b18.js.map

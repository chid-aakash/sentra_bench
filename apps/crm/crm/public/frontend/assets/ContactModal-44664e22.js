import{F as I}from"./FieldLayout-9051362d.js";import{i as B,E as j}from"./DragVerticalIcon-56a1fcba.js";import{u as D}from"./index-1be1092b.js";import{u as F,s as N,a as Q,c as z,q as A}from"./modals-6b779b18.js";import{K as O,m as q,B as P,i as R,l as S,z as T,a as U,I as C,e as m,f as p,g as _,w as f,d as c,t as J,u as i,b as r,p as g,E as K,J as L}from"./index-77a1adb3.js";const $={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},G={class:"mb-5 flex items-center justify-between"},H={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},W={class:"flex items-center gap-1"},X={class:"px-4 pb-7 pt-4 sm:px-6"},Y={class:"space-y-2"},Z={__name:"ContactModal",props:q({contact:{type:Object,default:{}},options:{type:Object,default:{redirect:!0,afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(y){const l=y,{isManager:x}=D(),k=P(),d=R(y,"modelValue"),M=S(!1),{document:e}=F("Contact");async function w(){e.doc.email_id&&(e.doc.email_ids=[{email_id:e.doc.email_id}],delete e.doc.email_id),e.doc.mobile_no&&(e.doc.phone_nos=[{phone:e.doc.mobile_no}],delete e.doc.mobile_no);const t=await K("frappe.client.insert",{doc:{doctype:"Contact",...e.doc}});t.name&&(L("contact_created"),E(t))}function E(t){var a,s;(s=(a=l.contact)==null?void 0:a.reload)==null||s.call(a),t.name&&l.options.redirect&&k.push({name:"Contact",params:{contactId:t.name}}),d.value=!1,l.options.afterInsert&&l.options.afterInsert(t)}const v=T({url:"crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["QuickEntry","Contact"],params:{doctype:"Contact",type:"Quick Entry"},auto:!0,transform:t=>t.forEach(a=>{a.sections.forEach(s=>{s.columns.forEach(u=>{u.fields.forEach(o=>{o.fieldname=="email_id"||o.fieldname=="mobile_no"?o.read_only=!1:o.fieldname=="address"?(o.create=(n,h)=>{e.doc.address=n,b(),h()},o.edit=n=>b(n)):o.fieldtype==="Table"&&(e.doc[o.fieldname]=[])})})})})});U(()=>{e.doc={},Object.assign(e.doc,l.contact.data||l.contact)});function V(){z.value=!0,A.value={doctype:"Contact"},C(()=>d.value=!1)}function b(t){N.value=!0,Q.value={doctype:"Address",address:t},C(()=>d.value=!1)}return(t,a)=>{const s=m("Button"),u=m("FeatherIcon"),o=m("Dialog");return p(),_(o,{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=n=>d.value=n),options:{size:"xl"}},{body:f(()=>{var n;return[c("div",$,[c("div",G,[c("div",null,[c("h3",H,J(t.__("New Contact")),1)]),c("div",W,[i(x)()&&!i(B)?(p(),_(s,{key:0,variant:"ghost",class:"w-7",onClick:V},{icon:f(()=>[r(j)]),_:1})):g("",!0),r(s,{variant:"ghost",class:"w-7",onClick:a[0]||(a[0]=h=>d.value=!1)},{icon:f(()=>[r(u,{name:"x",class:"size-4"})]),_:1})])]),(n=i(v).data)!=null&&n.length?(p(),_(I,{key:0,tabs:i(v).data,data:i(e).doc,doctype:"Contact"},null,8,["tabs","data"])):g("",!0)]),c("div",X,[c("div",Y,[r(s,{class:"w-full",variant:"solid",label:t.__("Create"),loading:M.value,onClick:w},null,8,["label","loading"])])])]}),_:1},8,["modelValue"])}}},ne=O(Z,[["__scopeId","data-v-0563c31c"]]);export{ne as C};
//# sourceMappingURL=ContactModal-44664e22.js.map

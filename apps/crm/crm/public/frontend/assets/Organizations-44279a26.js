import{_ as I,a as S}from"./ViewControls-0243c1de.js";import{_ as j}from"./CustomActions-cc223af8.js";import{O as E}from"./OrganizationsIcon-64c9b845.js";import{_ as H}from"./LayoutHeader-bf851e4e.js";import{_ as J}from"./OrganizationModal-f2625186.js";import{m as P,h as G,i as T,j as U,s as K,k as Q,l as g,e as x,f as u,c as k,b as s,w as d,u as c,F as L,r as X,g as _,n as W,p as b,_ as Y,d as A,t as O,q as Z}from"./index-77a1adb3.js";import{_ as ee,H as N,a as te,b as le,c as oe,d as ae,e as se,f as ne}from"./ListRows-f93bf621.js";import{a as ie,b as ue,f as q,w as re,t as de}from"./index-1be1092b.js";import{_ as me}from"./Dropdown.vue_vue_type_script_setup_true_lang-20f66514.js";import{_ as pe}from"./ListFooter-88c0e00f.js";import"./FadedScrollableDiv-3bd2f113.js";import"./IconPicker-32bf6d73.js";import"./Popover-23375de3.js";import"./DragVerticalIcon-56a1fcba.js";import"./PinIcon-9a9cf1df.js";import"./DetailsIcon-5fbd1b96.js";import"./settings-efea4d57.js";import"./FieldLayout-9051362d.js";import"./modals-6b779b18.js";import"./IndicatorIcon-81343f13.js";import"./AssignmentModal-615be241.js";import"./label-ea862e17.js";const fe={key:0},ve=["onClick"],ce={key:1},ye={key:2},ke=["onClick"],ge={__name:"OrganizationsListView",props:P({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:P(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(m,{expose:z,emit:M}){const f=M,w=G(),y=T(m,"modelValue"),n=T(m,"list"),$=U(()=>{var i,o;return!!((o=(i=n.value.params)==null?void 0:i.filters)!=null&&o._liked_by)}),{user:F}=K();function V(i){if(i)return JSON.parse(i).includes(F)}Q(y,(i,o)=>{i!==o&&f("updatePageCount",i)});const v=g(null);return z({customListActions:U(()=>{var i;return(i=v.value)==null?void 0:i.customListActions})}),(i,o)=>{const t=x("Button"),C=x("FormControl");return u(),k(L,null,[s(c(se),{columns:m.columns,rows:m.rows,options:{getRowRoute:l=>({name:"Organization",params:{organizationId:l.name},query:{view:c(w).query.view,viewType:c(w).params.viewType}}),selectable:m.options.selectable,showTooltip:m.options.showTooltip,resizeColumn:m.options.resizeColumn},"row-key":"name","onUpdate:selections":o[2]||(o[2]=l=>f("selectionsChanged",l))},{default:d(()=>[s(c(ee),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:o[1]||(o[1]=l=>f("columnWidthUpdated"))},{default:d(()=>[(u(!0),k(L,null,X(m.columns,l=>(u(),_(c(te),{key:l.key,item:l,onColumnWidthUpdated:e=>f("columnWidthUpdated",l)},{default:d(()=>[l.key=="_liked_by"?(u(),_(t,{key:0,variant:"ghosted",class:W(["!h-4",$.value?"fill-red-500":"fill-white"]),onClick:o[0]||(o[0]=()=>f("applyLikeFilter"))},{default:d(()=>[s(N,{class:"h-4 w-4"})]),_:1},8,["class"])):b("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),s(le,{class:"mx-3 sm:mx-5",rows:m.rows,doctype:"CRM Organization"},{default:d(({idx:l,column:e,item:r})=>[s(c(oe),{item:r,align:e.align},{prefix:d(()=>[e.key==="organization_name"?(u(),k("div",fe,[r.label?(u(),_(c(ie),{key:0,class:"flex items-center",image:r.logo,label:r.label,size:"sm"},null,8,["image","label"])):b("",!0)])):b("",!0)]),default:d(({label:a})=>[["modified","creation"].includes(e.key)?(u(),k("div",{key:0,class:"truncate text-base",onClick:p=>f("applyFilter",{event:p,idx:l,column:e,item:r,firstColumn:m.columns[0]})},[s(c(Y),{text:r.label},{default:d(()=>[A("div",null,O(r.timeAgo),1)]),_:2},1032,["text"])],8,ve)):e.type==="Check"?(u(),k("div",ce,[s(C,{type:"checkbox",modelValue:r,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):e.key==="_liked_by"?(u(),k("div",ye,[e.key=="_liked_by"?(u(),_(t,{key:0,variant:"ghosted",class:W(V(r)?"fill-red-500":"fill-white"),onClick:Z(()=>f("likeDoc",{name:i.row.name,liked:V(r)}),["stop","prevent"])},{default:d(()=>[s(N,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):b("",!0)])):(u(),k("div",{key:3,class:"truncate text-base",onClick:p=>f("applyFilter",{event:p,idx:l,column:e,item:r,firstColumn:m.columns[0]})},O(a),9,ke))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),s(c(ae),null,{actions:d(({selections:l,unselectAll:e})=>[s(c(me),{options:v.value.bulkActions(l,e)},{default:d(()=>[s(t,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),s(c(pe),{class:"border-t sm:px-5 px-3 py-2",modelValue:y.value,"onUpdate:modelValue":o[3]||(o[3]=l=>y.value=l),options:{rowCount:m.options.rowCount,totalCount:m.options.totalCount},onLoadMore:o[4]||(o[4]=l=>f("loadMore"))},null,8,["modelValue","options"]),s(ne,{ref_key:"listBulkActionsRef",ref:v,modelValue:n.value,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value=l),doctype:"CRM Organization",options:{hideAssign:!0}},null,8,["modelValue"])],64)}}},Ce={key:1,class:"flex h-full items-center justify-center"},_e={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},Se={__name:"Organizations",setup(m){const{getFormattedPercent:z,getFormattedFloat:M,getFormattedCurrency:f}=ue("CRM Organization"),w=g(null),y=g(!1),n=g({}),$=g(1),F=g(1),V=g(20),v=g(null),i=U(()=>{var o,t,C;return!((t=(o=n.value)==null?void 0:o.data)!=null&&t.data)||!["list","group_by"].includes(n.value.data.view_type)?[]:(C=n.value)==null?void 0:C.data.data.map(l=>{var r;let e={};return(r=n.value)==null||r.data.rows.forEach(a=>{var B,R,h;e[a]=l[a];let p=(h=(R=(B=n.value)==null?void 0:B.data.columns)==null?void 0:R.find(D=>(D.key||D.value)==a))==null?void 0:h.type;p&&["Date","Datetime"].includes(p)&&!["modified","creation"].includes(a)&&(e[a]=q(l[a],"",!0,p=="Datetime")),p&&p=="Currency"&&(e[a]=f(a,l)),p&&p=="Float"&&(e[a]=M(a,l)),p&&p=="Percent"&&(e[a]=z(a,l)),a==="organization_name"?e[a]={label:l.organization_name,logo:l.organization_logo}:a==="website"?e[a]=re(l.website):["modified","creation"].includes(a)&&(e[a]={label:q(l[a]),timeAgo:__(de(l[a]))})}),e})});return(o,t)=>{const C=x("FeatherIcon"),l=x("Button");return u(),k(L,null,[s(H,null,{"left-header":d(()=>[s(S,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),routeName:"Organizations"},null,8,["modelValue"])]),"right-header":d(()=>{var e;return[(e=w.value)!=null&&e.customListActions?(u(),_(j,{key:0,actions:w.value.customListActions},null,8,["actions"])):b("",!0),s(l,{variant:"solid",label:o.__("Create"),onClick:t[1]||(t[1]=r=>y.value=!0)},{prefix:d(()=>[s(C,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),s(I,{ref_key:"viewControls",ref:v,modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=e=>n.value=e),loadMore:$.value,"onUpdate:loadMore":t[3]||(t[3]=e=>$.value=e),resizeColumn:F.value,"onUpdate:resizeColumn":t[4]||(t[4]=e=>F.value=e),updatedPageCount:V.value,"onUpdate:updatedPageCount":t[5]||(t[5]=e=>V.value=e),doctype:"CRM Organization"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),n.value.data&&i.value.length?(u(),_(ge,{key:0,ref_key:"organizationsListView",ref:w,modelValue:n.value.data.page_length_count,"onUpdate:modelValue":t[6]||(t[6]=e=>n.value.data.page_length_count=e),list:n.value,"onUpdate:list":t[7]||(t[7]=e=>n.value=e),rows:i.value,columns:n.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:n.value.data.row_count,totalCount:n.value.data.total_count},onLoadMore:t[8]||(t[8]=()=>$.value++),onColumnWidthUpdated:t[9]||(t[9]=()=>F.value++),onUpdatePageCount:t[10]||(t[10]=e=>V.value=e),onApplyFilter:t[11]||(t[11]=e=>v.value.applyFilter(e)),onApplyLikeFilter:t[12]||(t[12]=e=>v.value.applyLikeFilter(e)),onLikeDoc:t[13]||(t[13]=e=>v.value.likeDoc(e)),onSelectionsChanged:t[14]||(t[14]=e=>v.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):n.value.data?(u(),k("div",Ce,[A("div",_e,[s(E,{class:"h-10 w-10"}),A("span",null,O(o.__("No {0} Found",[o.__("Organizations")])),1),s(l,{label:o.__("Create"),onClick:t[15]||(t[15]=e=>y.value=!0)},{prefix:d(()=>[s(C,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):b("",!0),y.value?(u(),_(J,{key:2,modelValue:y.value,"onUpdate:modelValue":t[16]||(t[16]=e=>y.value=e)},null,8,["modelValue"])):b("",!0)],64)}}};export{Se as default};
//# sourceMappingURL=Organizations-44279a26.js.map
